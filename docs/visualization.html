<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data visualization | R for social science and business analytics</title>
  <meta name="description" content="Chapter 4 Data visualization | R for social science and business analytics" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data visualization | R for social science and business analytics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 4 Data visualization | R for social science and business analytics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data visualization | R for social science and business analytics" />
  
  <meta name="twitter:description" content="Chapter 4 Data visualization | R for social science and business analytics" />
  

<meta name="author" content="Raffaele Vacca" />


<meta name="date" content="2024-06-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="wrangling.html"/>
<link rel="next" href="reproducible.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Contents</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview and setup</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#setup"><i class="fa fa-check"></i><b>1.1</b> Workshop setup</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#materials"><i class="fa fa-check"></i><b>1.2</b> Workshop materials</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#r-settings"><i class="fa fa-check"></i><b>1.3</b> R settings</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#packages"><i class="fa fa-check"></i><b>1.3.1</b> Required R packages</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#rstudio-options"><i class="fa fa-check"></i><b>1.3.2</b> RStudio options</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.4</b> Data</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#author-and-contacts"><i class="fa fa-check"></i><b>1.5</b> Author and contacts</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#starting-R-and-loading-packages"><i class="fa fa-check"></i><b>2.1</b> Starting R and loading packages</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#console-vs-scripts"><i class="fa fa-check"></i><b>2.1.1</b> Console vs scripts</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#getting-help"><i class="fa fa-check"></i><b>2.1.2</b> Getting help</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#objects-in-r"><i class="fa fa-check"></i><b>2.2</b> Objects in R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#the-workspace"><i class="fa fa-check"></i><b>2.2.1</b> The workspace</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#saving-and-removing-objects"><i class="fa fa-check"></i><b>2.2.2</b> Saving and removing objects</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#vector-and-matrix-objects"><i class="fa fa-check"></i><b>2.2.3</b> Vector and matrix objects</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#dataframes"><i class="fa fa-check"></i><b>2.2.4</b> Data frames</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#lists"><i class="fa fa-check"></i><b>2.2.5</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#arithmetic-statistical-and-relational-operations"><i class="fa fa-check"></i><b>2.3</b> Arithmetic, statistical, and relational operations</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#arithmetic-operations-and-recycling"><i class="fa fa-check"></i><b>2.3.1</b> Arithmetic operations and recycling</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#relational-operations-and-logical-vectors"><i class="fa fa-check"></i><b>2.3.2</b> Relational operations and logical vectors</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#examples-of-arithmetic-and-statistical-functions"><i class="fa fa-check"></i><b>2.3.3</b> Examples of arithmetic and statistical functions</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#missing-and-infinite-values"><i class="fa fa-check"></i><b>2.3.4</b> Missing and infinite values</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#subsetting"><i class="fa fa-check"></i><b>2.4</b> Subsetting</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#index-df"><i class="fa fa-check"></i><b>2.4.1</b> Subsetting data frames</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#pipes-and-the-operator"><i class="fa fa-check"></i><b>2.5</b> Pipes and the <code>|&gt;</code> operator</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#functions"><i class="fa fa-check"></i><b>2.6</b> Writing your own R functions</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#types-and-classes-of-objects"><i class="fa fa-check"></i><b>2.7</b> Types and classes of objects</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>3</b> Data wrangling and descriptive statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="wrangling.html"><a href="wrangling.html#subsetting-and-renaming-variables"><i class="fa fa-check"></i><b>3.1</b> Subsetting and renaming variables</a></li>
<li class="chapter" data-level="3.2" data-path="wrangling.html"><a href="wrangling.html#recoding-cleaning-creating-variables"><i class="fa fa-check"></i><b>3.2</b> Recoding, cleaning, creating variables</a></li>
<li class="chapter" data-level="3.3" data-path="wrangling.html"><a href="wrangling.html#filtering-and-rearranging-cases"><i class="fa fa-check"></i><b>3.3</b> Filtering and rearranging cases</a></li>
<li class="chapter" data-level="3.4" data-path="wrangling.html"><a href="wrangling.html#saving-the-data"><i class="fa fa-check"></i><b>3.4</b> Saving the data</a></li>
<li class="chapter" data-level="3.5" data-path="wrangling.html"><a href="wrangling.html#describing-or-summarizing-the-data"><i class="fa fa-check"></i><b>3.5</b> Describing or summarizing the data</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="wrangling.html"><a href="wrangling.html#with-dplyrsummarize"><i class="fa fa-check"></i><b>3.5.1</b> With <code>dplyr::summarize()</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="wrangling.html"><a href="wrangling.html#with-specific-functions-for-descriptive-analysis"><i class="fa fa-check"></i><b>3.5.2</b> With specific functions for descriptive analysis</a></li>
<li class="chapter" data-level="3.5.3" data-path="wrangling.html"><a href="wrangling.html#descriptive-statistics-by-group"><i class="fa fa-check"></i><b>3.5.3</b> Descriptive statistics by group</a></li>
<li class="chapter" data-level="3.5.4" data-path="wrangling.html"><a href="wrangling.html#export-results"><i class="fa fa-check"></i><b>3.5.4</b> Export results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>4</b> Data visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualization.html"><a href="visualization.html#univariate-distributions"><i class="fa fa-check"></i><b>4.1</b> Univariate distributions</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="visualization.html"><a href="visualization.html#continuous-variables-histograms-and-boxplots"><i class="fa fa-check"></i><b>4.1.1</b> Continuous variables: histograms and boxplots</a></li>
<li class="chapter" data-level="4.1.2" data-path="visualization.html"><a href="visualization.html#categorical-variables-simple-barplots"><i class="fa fa-check"></i><b>4.1.2</b> Categorical variables: simple barplots</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="visualization.html"><a href="visualization.html#associations-between-two-variables"><i class="fa fa-check"></i><b>4.2</b> Associations between two variables</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visualization.html"><a href="visualization.html#two-continuous-variables-scatterplots"><i class="fa fa-check"></i><b>4.2.1</b> Two continuous variables: scatterplots</a></li>
<li class="chapter" data-level="4.2.2" data-path="visualization.html"><a href="visualization.html#two-categorical-variables-complex-barplots"><i class="fa fa-check"></i><b>4.2.2</b> Two categorical variables: complex barplots</a></li>
<li class="chapter" data-level="4.2.3" data-path="visualization.html"><a href="visualization.html#one-continuous-and-one-categorical-variable-boxplots-and-faceted-histograms"><i class="fa fa-check"></i><b>4.2.3</b> One continuous and one categorical variable: boxplots and faceted histograms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="reproducible.html"><a href="reproducible.html"><i class="fa fa-check"></i><b>5</b> Creating reproducible reports</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for social science and business analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualization" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Data visualization<a href="visualization.html#visualization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We will now create and discuss data visualizations based on ggplot2 and the grammar of graphics. This chapter draws from the <a href="https://rstudio.github.io/cheatsheets/html/data-visualization.html?_gl=1*10368jz*_ga*MjQ1OTc2NzA0LjE3MTIxMzM1NTU.*_ga_2C0WZ1JHG0*MTcxMzUyMzU4My40LjEuMTcxMzUyMzYxNS4wLjAuMA..">ggplot2 Cheat Sheet</a>, the <a href="https://ggplot2.tidyverse.org/">ggplot2 website</a>, the <a href="https://r4ds.hadley.nz/data-visualize.html">visualization chapter</a> from Wickham and Grolemund’s <em>R for Data Science</em>, and the third edition (in progress) of Wickham’s <a href="https://ggplot2-book.org/">ggplot2 textbook</a>.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="visualization.html#cb351-1" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb351-2"><a href="visualization.html#cb351-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb351-3"><a href="visualization.html#cb351-3" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb351-4"><a href="visualization.html#cb351-4" tabindex="-1"></a></span>
<span id="cb351-5"><a href="visualization.html#cb351-5" tabindex="-1"></a><span class="co"># Clear the workspace</span></span>
<span id="cb351-6"><a href="visualization.html#cb351-6" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb351-7"><a href="visualization.html#cb351-7" tabindex="-1"></a></span>
<span id="cb351-8"><a href="visualization.html#cb351-8" tabindex="-1"></a><span class="co"># Let&#39;s load the data we cleaned in the previous chapter</span></span>
<span id="cb351-9"><a href="visualization.html#cb351-9" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;my_data.rda&quot;</span>)</span></code></pre></div>
<p>In its simplest form, any ggplot2 graph is created with the following type of code:</p>
<pre><code>ggplot(data = &lt;Data&gt;) +
  &lt;Geom_Function&gt;(mapping = aes(&lt;Mappings&gt;)) +
  &lt;Scale_Function&gt; +
  &lt;Theme_Function&gt;</code></pre>
<p>We will now discuss the five graph components that are visible in that code:</p>
<ul>
<li><code>&lt;Data&gt;</code>: the underlying <strong>data</strong>.</li>
<li><code>&lt;Geom_Function&gt;</code>: geometrical objects (or <strong>geoms</strong>). A plot consists of one or more geoms, one in each <strong>layer</strong> of the plot. Note that we can add multiple layers (therefore multiple geoms) in the same plot.</li>
<li><code>&lt;Mappings&gt;</code>: an aesthetic mapping from variables in the data to visual properties (i.e., <strong>aesthetics</strong>) of a geom. There are one or more aesthetic mappings for each geom.</li>
<li><code>&lt;Scale_Function&gt;</code>: a <strong>scale</strong> that assigns a specific visual attribute (i.e., a value of the aesthetic) to each value of a variable in the data. Each aesthetic mapping has one scale.</li>
<li><code>&lt;Theme_Function&gt;</code>: general, non-data graphical elements of the plot (e.g., background color, text fonts, etc.).</li>
</ul>
<div id="univariate-distributions" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Univariate distributions<a href="visualization.html#univariate-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="continuous-variables-histograms-and-boxplots" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Continuous variables: histograms and boxplots<a href="visualization.html#continuous-variables-histograms-and-boxplots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Histograms.</strong></p>
<p>Here we only have one aesthetic mapping in <code>aes()</code>: values of <code>age</code> are mapped to values of <code>x</code> (the horizontal axis).</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="visualization.html#cb353-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb353-2"><a href="visualization.html#cb353-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> age))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins =
## 30`. Pick better value with
## `binwidth`.</code></pre>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Note that there is also a <em>statistical transformation</em> being applied to the data before plotting (<em>which one?</em>). We can modify that transformation of the data: for example, pick a different width for the histogram bins.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="visualization.html#cb355-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb355-2"><a href="visualization.html#cb355-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> age), <span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Modify visual properties of the plot: bin color and fill.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="visualization.html#cb356-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb356-2"><a href="visualization.html#cb356-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> age), <span class="at">binwidth =</span> <span class="dv">1</span>,</span>
<span id="cb356-3"><a href="visualization.html#cb356-3" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Modify the scale of the <code>x</code> aesthetic mapping.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="visualization.html#cb357-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb357-2"><a href="visualization.html#cb357-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> age), <span class="at">binwidth =</span> <span class="dv">1</span>,</span>
<span id="cb357-3"><a href="visualization.html#cb357-3" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb357-4"><a href="visualization.html#cb357-4" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="at">by =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Modify the general theme of the plot.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="visualization.html#cb358-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb358-2"><a href="visualization.html#cb358-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> age), <span class="at">binwidth =</span> <span class="dv">1</span>,</span>
<span id="cb358-3"><a href="visualization.html#cb358-3" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb358-4"><a href="visualization.html#cb358-4" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb358-5"><a href="visualization.html#cb358-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Let’s add another geom in a new layer: a density plot. Note that now the bin height and y axis are not count values but density values: this is specified by setting the <code>y</code> aesthetic in <code>aes()</code>.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="visualization.html#cb359-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb359-2"><a href="visualization.html#cb359-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">binwidth =</span> <span class="dv">1</span>,</span>
<span id="cb359-3"><a href="visualization.html#cb359-3" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb359-4"><a href="visualization.html#cb359-4" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> age), <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb359-5"><a href="visualization.html#cb359-5" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb359-6"><a href="visualization.html#cb359-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p><strong>Boxplots.</strong></p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="visualization.html#cb360-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb360-2"><a href="visualization.html#cb360-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age))</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>In a new layer, we can use a new geom to add the actual data points on top of the boxplot (with some vertical jittering).</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="visualization.html#cb361-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">194</span>)</span>
<span id="cb361-2"><a href="visualization.html#cb361-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb361-3"><a href="visualization.html#cb361-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> <span class="dv">0</span>), </span>
<span id="cb361-4"><a href="visualization.html#cb361-4" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb361-5"><a href="visualization.html#cb361-5" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">h =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb361-6"><a href="visualization.html#cb361-6" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age), <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="categorical-variables-simple-barplots" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Categorical variables: simple barplots<a href="visualization.html#categorical-variables-simple-barplots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Simple barplots</strong>.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="visualization.html#cb362-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb362-2"><a href="visualization.html#cb362-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> edu))</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Two aesthetics (<code>x</code> and <code>fill</code>) for the same variable (<code>edu</code>).</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="visualization.html#cb363-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb363-2"><a href="visualization.html#cb363-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> edu, <span class="at">fill =</span> edu))</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Note the importance of the order of levels in <code>edu</code> factor.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="visualization.html#cb364-1" tabindex="-1"></a><span class="co"># Original level order</span></span>
<span id="cb364-2"><a href="visualization.html#cb364-2" tabindex="-1"></a>data<span class="sc">$</span>edu <span class="sc">|&gt;</span> </span>
<span id="cb364-3"><a href="visualization.html#cb364-3" tabindex="-1"></a>  <span class="fu">levels</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Medie o meno&quot; &quot;Superiori&quot;    &quot;Laurea&quot;       &quot;Post-laurea&quot;  &quot;Altro&quot;</code></pre>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="visualization.html#cb366-1" tabindex="-1"></a><span class="co"># Let&#39;s change it to this:</span></span>
<span id="cb366-2"><a href="visualization.html#cb366-2" tabindex="-1"></a>data<span class="sc">$</span>edu <span class="sc">|&gt;</span></span>
<span id="cb366-3"><a href="visualization.html#cb366-3" tabindex="-1"></a>  <span class="fu">fct_rev</span>() <span class="sc">|&gt;</span> </span>
<span id="cb366-4"><a href="visualization.html#cb366-4" tabindex="-1"></a>  <span class="fu">levels</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Altro&quot;        &quot;Post-laurea&quot;  &quot;Laurea&quot;       &quot;Superiori&quot;    &quot;Medie o meno&quot;</code></pre>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="visualization.html#cb368-1" tabindex="-1"></a><span class="co"># Make the change in the data</span></span>
<span id="cb368-2"><a href="visualization.html#cb368-2" tabindex="-1"></a>data.rev <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb368-3"><a href="visualization.html#cb368-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">edu =</span> <span class="fu">fct_rev</span>(edu))</span>
<span id="cb368-4"><a href="visualization.html#cb368-4" tabindex="-1"></a></span>
<span id="cb368-5"><a href="visualization.html#cb368-5" tabindex="-1"></a><span class="co"># Not plot with the new level order</span></span>
<span id="cb368-6"><a href="visualization.html#cb368-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data.rev) <span class="sc">+</span></span>
<span id="cb368-7"><a href="visualization.html#cb368-7" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> edu, <span class="at">fill =</span> edu))</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Back to the original level order, modify the fill color scale (and theme).</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="visualization.html#cb369-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb369-2"><a href="visualization.html#cb369-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> edu, <span class="at">fill =</span> edu)) <span class="sc">+</span></span>
<span id="cb369-3"><a href="visualization.html#cb369-3" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Medie o meno</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;#002e4e&quot;</span>, </span>
<span id="cb369-4"><a href="visualization.html#cb369-4" tabindex="-1"></a>                               <span class="at">Superiori =</span> <span class="st">&quot;#afe1da&quot;</span>, </span>
<span id="cb369-5"><a href="visualization.html#cb369-5" tabindex="-1"></a>                               <span class="at">Laurea =</span> <span class="st">&quot;#ff4639&quot;</span>, </span>
<span id="cb369-6"><a href="visualization.html#cb369-6" tabindex="-1"></a>                               <span class="st">`</span><span class="at">Post-laurea</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;#b4abd7&quot;</span>, </span>
<span id="cb369-7"><a href="visualization.html#cb369-7" tabindex="-1"></a>                               <span class="at">Altro =</span> <span class="st">&quot;#fad774&quot;</span>)) <span class="sc">+</span></span>
<span id="cb369-8"><a href="visualization.html#cb369-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
</div>
<div id="associations-between-two-variables" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Associations between two variables<a href="visualization.html#associations-between-two-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="two-continuous-variables-scatterplots" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Two continuous variables: scatterplots<a href="visualization.html#two-continuous-variables-scatterplots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s first consider the association between <code>age</code> and <code>work.exp.y</code> (years of experience in current company). We expect a positive association</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="visualization.html#cb370-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb370-2"><a href="visualization.html#cb370-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> work.exp.y))</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Note that there is a lot of overplotting: many of those dots represent multiple data points (what makes us suspicious about this is that points are too neatly arranged as in a grid). Indeed, for each unique combination of <code>age</code> and <code>work.exp.y</code> there are multiple data points (i.e. multiple respondents):</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="visualization.html#cb371-1" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb371-2"><a href="visualization.html#cb371-2" tabindex="-1"></a>  <span class="fu">group_by</span>(age, work.exp.y) <span class="sc">|&gt;</span> </span>
<span id="cb371-3"><a href="visualization.html#cb371-3" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">|&gt;</span> </span>
<span id="cb371-4"><a href="visualization.html#cb371-4" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 530 × 3
## # Groups:   age, work.exp.y
## #   [530]
##      age work.exp.y     n
##    &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;
##  1    51         30     7
##  2    53         32     7
##  3    54         32     7
##  4    56         35     7
##  5    30          2     6
##  6    42         15     6
##  7    49         22     6
##  8    56         30     6
##  9    57         33     6
## 10    57         35     6
## # ℹ 520 more rows</code></pre>
<p>To see this more clearly in the plot, we can change point shape to hollow point and add a little horizontal jittering.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="visualization.html#cb373-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">106</span>)</span>
<span id="cb373-2"><a href="visualization.html#cb373-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb373-3"><a href="visualization.html#cb373-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> work.exp.y), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="fl">0.3</span>))</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>The positive association between the <em>x</em> and <em>y</em> variables can be seen more clearly if we add, in a new layer, the smoothing line that best approximates the relationship between <em>x</em> and <em>y</em>. Note that now we have two geoms with the same <code>aes()</code> argument, so we move <code>aes()</code> into the <code>ggplot()</code> call to avoid having to repeat it in both geom calls.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="visualization.html#cb374-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">106</span>)</span>
<span id="cb374-2"><a href="visualization.html#cb374-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> work.exp.y)) <span class="sc">+</span></span>
<span id="cb374-3"><a href="visualization.html#cb374-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb374-4"><a href="visualization.html#cb374-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method
## = &#39;gam&#39; and formula = &#39;y ~
## s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>Let’s do the same plot for another pair of continuous variables: <code>age</code> and <code>driver.sum</code>. The latter is the sum of all answers (converted to numeric) to the 24 “driver” questions: an overall score of a respondent’s tendency to agree that the “drivers” listed in the survey are important. We’ll change colors and theme just to show some graphical variation.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="visualization.html#cb376-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">106</span>)</span>
<span id="cb376-2"><a href="visualization.html#cb376-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> driver.sum)) <span class="sc">+</span></span>
<span id="cb376-3"><a href="visualization.html#cb376-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb376-4"><a href="visualization.html#cb376-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb376-5"><a href="visualization.html#cb376-5" tabindex="-1"></a>  <span class="fu">theme_dark</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method
## = &#39;gam&#39; and formula = &#39;y ~
## s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="two-categorical-variables-complex-barplots" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Two categorical variables: complex barplots<a href="visualization.html#two-categorical-variables-complex-barplots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we want to visualize the relationship between two categorical variables: generation (<code>gen</code>) and education level (<code>edu</code>). You can think of the data we want to view as a table of counts (<em>absolute frequencies</em>) of <code>edu</code> categories in each <code>gen</code> category:</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="visualization.html#cb378-1" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb378-2"><a href="visualization.html#cb378-2" tabindex="-1"></a>  <span class="fu">tabyl</span>(edu, gen) </span></code></pre></div>
<pre><code>##           edu baby boomers gen x millennials gen z
##  Medie o meno            3    18           2     0
##     Superiori           62   289          62     3
##        Laurea           34   166         149    10
##   Post-laurea            4    66          71     3
##         Altro            7    37          13     1</code></pre>
<p>We can also think of the data as <em>relative frequencies</em> of <code>edu</code> categories in each <code>gen</code> category:</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="visualization.html#cb380-1" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb380-2"><a href="visualization.html#cb380-2" tabindex="-1"></a>  <span class="fu">tabyl</span>(edu, gen) <span class="sc">|&gt;</span> </span>
<span id="cb380-3"><a href="visualization.html#cb380-3" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>(<span class="at">denominator =</span> <span class="st">&quot;col&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb380-4"><a href="visualization.html#cb380-4" tabindex="-1"></a>  <span class="fu">adorn_rounding</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##           edu baby boomers gen x millennials gen z
##  Medie o meno         0.03  0.03        0.01  0.00
##     Superiori         0.56  0.50        0.21  0.18
##        Laurea         0.31  0.29        0.50  0.59
##   Post-laurea         0.04  0.11        0.24  0.18
##         Altro         0.06  0.06        0.04  0.06</code></pre>
<p>Alternatively, we can look at the relative frequencies of <code>gen</code> categories in each <code>edu</code> category:</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="visualization.html#cb382-1" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb382-2"><a href="visualization.html#cb382-2" tabindex="-1"></a>  <span class="fu">tabyl</span>(edu, gen) <span class="sc">|&gt;</span> </span>
<span id="cb382-3"><a href="visualization.html#cb382-3" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>(<span class="at">denominator =</span> <span class="st">&quot;row&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb382-4"><a href="visualization.html#cb382-4" tabindex="-1"></a>  <span class="fu">adorn_rounding</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##           edu baby boomers gen x millennials gen z
##  Medie o meno         0.13  0.78        0.09  0.00
##     Superiori         0.15  0.69        0.15  0.01
##        Laurea         0.09  0.46        0.42  0.03
##   Post-laurea         0.03  0.46        0.49  0.02
##         Altro         0.12  0.64        0.22  0.02</code></pre>
<p><strong>Grouped barplots.</strong></p>
<p>We start by plotting the counts of educational categories in each generation. Here, each bar is an educational category <em>within</em> a generation category. Bars are grouped by generation: each generation is a group with one position on the x axis, and all bars for one generation are plotted side by side around that generation’s x position. Note that we transform <code>gen</code> with <code>fct_rev()</code> so as to have younger generations first, that is, younger on the left and older on the right (the transformation is done within the plot, it doesn’t affect the <code>data</code> object).</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="visualization.html#cb384-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb384-2"><a href="visualization.html#cb384-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_rev</span>(gen), <span class="at">fill =</span> edu), <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>The <code>position = "dodge"</code> argument is what tells R to put the different <code>edu</code> bars in the same <code>gen</code> category side by side. We can invert <code>gen</code> and <code>edu</code>, by setting <code>edu</code> as the group and x position, and <code>gen</code> as the categories to be plotted side by side in the same <code>edu</code> group:</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="visualization.html#cb385-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb385-2"><a href="visualization.html#cb385-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> edu, <span class="at">fill =</span> <span class="fu">fct_rev</span>(gen)), <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>If we omit the <code>position</code> argument, the bars will be plotted one on top of the other: a stacked barplot.</p>
<p><strong>Stacked barplots.</strong></p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="visualization.html#cb386-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb386-2"><a href="visualization.html#cb386-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_rev</span>(gen), <span class="at">fill =</span> edu))</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>Note that these are counts: we are not seeing the relative frequencies of <code>edu</code> categories within each generation, and generations with more respondents (e.g., Gen X) correspond to taller bars (counts are larger).</p>
<p>To get relative frequencies (i.e. proportions or percentages) in each generation, standardizing all bar heights to the same (1 or 100), we set the <code>position</code> argument to <code>"fill"</code>. Now we see a clear pattern of association between generation and education level.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="visualization.html#cb387-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb387-2"><a href="visualization.html#cb387-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_rev</span>(gen), <span class="at">fill =</span> edu), <span class="at">position =</span> <span class="st">&quot;fill&quot;</span>)</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="one-continuous-and-one-categorical-variable-boxplots-and-faceted-histograms" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> One continuous and one categorical variable: boxplots and faceted histograms<a href="visualization.html#one-continuous-and-one-categorical-variable-boxplots-and-faceted-histograms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Boxplots.</strong></p>
<p>We have already seen boxplots. Since a boxplot is a very parsimonious and concise way of displaying a univariate distribution, we can easily draw multiple boxplots – one for each group – to compare the univariate distribution of the same variable (e.g., <code>driver.sum</code>) in different groups (e.g., generations) side by side. All we need is set the continous variable as the <em>x</em> aesthetic and the categorical variable as the <em>y</em> (or viceversa for vertical boxplots):</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="visualization.html#cb388-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb388-2"><a href="visualization.html#cb388-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> driver.sum, <span class="at">y =</span> gen))</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>We do see some pattern here (<em>what is that?</em>).</p>
<p><strong>Faceted histograms.</strong></p>
<p>Whenever we have a categorical variable, we can use <strong>facets</strong> to create the same plot for each group (i.e., category) of that categorical variable. In other words, the same plot will have multiple facets, each facet corresponding to one category. In this way, we can create, for example, the same histogram of <code>driver.sum</code> for each <code>gen</code> category separately. Let’s start by creating the one <code>driver.sum</code> histogram we want:</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="visualization.html#cb389-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb389-2"><a href="visualization.html#cb389-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> driver.sum, <span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb389-3"><a href="visualization.html#cb389-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>By adding a facet function, we can now create the same plot for each facet (e.g., <code>gen</code> category):</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="visualization.html#cb390-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data) <span class="sc">+</span></span>
<span id="cb390-2"><a href="visualization.html#cb390-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> driver.sum, <span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb390-3"><a href="visualization.html#cb390-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> gen) <span class="sc">+</span></span>
<span id="cb390-4"><a href="visualization.html#cb390-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>Faceting functions in ggplot2 are very flexible and allow us to explore any kind of grouping by one or more categorical variable. For example, we may want to look at intersections of generations and genders, that is, generation-gender groups. With <code>facet_grid()</code>, we can have a neat matrix with generations as rows and genders as columns, each cell being a generation-gender combination:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="visualization.html#cb391-1" tabindex="-1"></a><span class="co"># For simplicity, let&#39;s first subset the data to just Male and Female genders.</span></span>
<span id="cb391-2"><a href="visualization.html#cb391-2" tabindex="-1"></a>data.mf <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb391-3"><a href="visualization.html#cb391-3" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Donna&quot;</span>, <span class="st">&quot;Uomo&quot;</span>))</span>
<span id="cb391-4"><a href="visualization.html#cb391-4" tabindex="-1"></a></span>
<span id="cb391-5"><a href="visualization.html#cb391-5" tabindex="-1"></a><span class="co"># Now plot</span></span>
<span id="cb391-6"><a href="visualization.html#cb391-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data.mf) <span class="sc">+</span></span>
<span id="cb391-7"><a href="visualization.html#cb391-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> driver.sum, <span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb391-8"><a href="visualization.html#cb391-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(gen <span class="sc">~</span> gender) <span class="sc">+</span></span>
<span id="cb391-9"><a href="visualization.html#cb391-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="R-for-social-research-and-business-analytics_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="wrangling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reproducible.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R for social research and business analytics.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
